import random
import csv

#############################
# 1. 회사별 상품명 확장 (100개)
#############################

base_products = {
    "삼성화재": [
        "삼성화재 뉴 암보험",
        "삼성화재 건강보험 통합",
        "삼성화재 종신보험 스마트",
        "삼성화재 운전자패키지 Plus",
        "삼성화재 치아보험 웰라이프",
        "삼성화재 The건강한 암케어",
        "삼성화재 다이렉트 실손건강",
        "삼성화재 행복한 암보장 플랜",
        "삼성화재 수술입원 통합보장",
        "삼성화재 무배당 내아이 건강보험",
        "삼성화재 신생아 희망케어",
        "삼성화재 치매간병 안심플랜",
        "삼성화재 스마트 운전자케어",
        "삼성화재 가정화재 종합보장",
        "삼성화재 알뜰한 치아케어"
    ],
    "DB손해보험": [
        "DB손해보험 참좋은 암보험",
        "DB손해보험 운전자보험 프로미",
        "DB손해보험 종합건강수술비",
        "DB손해보험 아이러브 건강보험",
        "DB손해보험 웰케어 실손보험",
        "DB손해보험 노블레스 종신보험",
        "DB손해보험 수술입원비 플러스",
        "DB손해보험 치아든든케어",
        "DB손해보험 고혈압당뇨 케어플랜",
        "DB손해보험 하우스안심 화재보험",
        "DB손해보험 다이렉트 운전자보험",
        "DB손해보험 암플러스 3대질환",
        "DB손해보험 치매간병 프리미엄",
        "DB손해보험 신생아미숙아 보장",
        "DB손해보험 가정종합화재 특별약정"
    ],
    "KB손해보험": [
        "KB 암보험 플래티넘",
        "KB 치아보험 스마일",
        "KB 운전자보험 스마트운전",
        "KB 종신보험 행복누리",
        "KB 치매간병보험 안심케어",
        "KB 종합건강보험 The Care",
        "KB 실손의료비 표준플랜",
        "KB 신생아케어 안심보장",
        "KB 주택화재 종합프로",
        "KB 운전자라이프 파워",
        "KB 무배당 암케어슈퍼",
        "KB 다이렉트 입원수술 종합",
        "KB 골든라이프 종신플랜",
        "KB 치아안심 파워케어",
        "KB 뇌심장질환 종합보장"
    ],
    "현대해상": [
        "현대해상 굿앤굿종합보험",
        "현대해상 하이카 운전자보험",
        "현대해상 신실손의료비보험",
        "현대해상 암스트롱 암보험",
        "현대해상 The 간편건강보험",
        "현대해상 수술입원 안심케어",
        "현대해상 종신플랜 브라이트",
        "현대해상 치아케어 치유플러스",
        "현대해상 주택화재 맘편한",
        "현대해상 신생아 고위험케어",
        "현대해상 운전자 패밀리안심",
        "현대해상 치매보장 뉴케어",
        "현대해상 다이렉트 건강입원비",
        "현대해상 노후실손 간편보장",
        "현대해상 수술비 더든든"
    ],
    "메리츠화재": [
        "메리츠 알파Plus 보장보험",
        "메리츠 운전자보험 안전플랜",
        "메리츠 치아보험 내돈제로",
        "메리츠 종신보험 든든케어",
        "메리츠 실손의료비 New",
        "메리츠 암보험 파워케어",
        "메리츠 어린이건강 행복지킴이",
        "메리츠 수술입원비 블루케어",
        "메리츠 암수술 특약플러스",
        "메리츠 치아사랑 메디케어",
        "메리츠 주택화재 가정지킴이",
        "메리츠 치매든든 종합간병",
        "메리츠 단독운전자 안심보장",
        "메리츠 유니버셜 종신플랜",
        "메리츠 실버케어 건강입원"
    ],
    "한화손해보험": [
        "한화손해 저축성 종신보험",
        "한화손해 스마트치아보험",
        "한화손해 암보험 3대질환케어",
        "한화손해 안심운전자 종합",
        "한화손해 주택화재 AllSafe",
        "한화손해 실손의료비 표준형",
        "한화손해 치매케어 파워플랜",
        "한화손해 어린이 New케어",
        "한화손해 하이종신 든든보장",
        "한화손해 암수술비 업그레이드",
        "한화손해 수술입원 The건강",
        "한화손해 신생아스페셜 보장",
        "한화손해 치아굿케어 A+",
        "한화손해 운전자배상 종합안심",
        "한화손해 노후치매 프리미엄"
    ],
    "롯데손해보험": [
        "롯데 가온종합보험",
        "롯데 치아건강보험",
        "롯데 암보험 바로OK",
        "롯데 운전자보험 드림카",
        "롯데 수술입원 종합케어",
        "롯데 종신보험 행복드림",
        "롯데 신생아 안심플랜",
        "롯데 치매보장 New해피라이프",
        "롯데 화재플러스 내집안심",
        "롯데 실손의료비표준 A형",
        "롯데 어린이건강 Smart",
        "롯데 운전자 무배당 프로",
        "롯데 치아실속케어 B형",
        "롯데 암입원프리미엄 플랜",
        "롯데 노후실손 든든케어"
    ],
    "흥국화재": [
        "흥국화재 착한운전자보험",
        "흥국화재 행복을다주는암보험",
        "흥국화재 간병치매보험 안심",
        "흥국화재 주택화재 럭키홈",
        "흥국화재 종신플러스 NewLife",
        "흥국화재 수술입원 Protect",
        "흥국화재 어린이미래 파워케어",
        "흥국화재 치아클리닉 굿케어",
        "흥국화재 운전자안전 all-in",
        "흥국화재 신생아 출산플랜",
        "흥국화재 암간병 든든플러스",
        "흥국화재 실손건강 표준형",
        "흥국화재 치매간병 해피라이프",
        "흥국화재 노후장기 케어플랜",
        "흥국화재 유니버셜 종신 New"
    ]
}

# 회사별 상품 100개까지 확장
for company, product_list in base_products.items():
    cur_len = len(product_list)
    if cur_len < 100:
        for i in range(cur_len+1, 101):
            product_list.append(f"{company} 추가상품{i}")

# 최종 회사-상품 딕셔너리
possible_products_final = base_products

#############################
# 2. 카테고리별 보장 문구 (50개)
#############################

base_coverage_details = {
    "암": [
        "주요암(유방암, 폐암, 대장암) 진단 시 고액 보장. 항암주사비, 방사선치료 특약 가능.",
        "초기암부터 재진단암까지 단계별 보장. 항암치료 후 관리 서비스 제공.",
        "갑상선암, 전립선암 등 소액암도 일시금 지원. 합병증 치료비까지 커버.",
        "표적항암약물 치료비, 면역치료 지원 특약. 고액치료비 한도 상향 옵션.",
        "뇌암, 백혈병, 골수암 등 희귀암 특화 보장. 진단 즉시 생활자금 지급.",
        "재진단암 2~3차까지 보장 확대. 수술·입원·통원까지 전담 케어팀 연계.",
        "수술 전후 자가치료비, 간병비 지원. 말기암 간병특약 별도 선택 가능.",
        "항암방사선 후유장해 집중 케어. 호스피스 비용까지 부분 지원.",
        "유전성 암 위험도 검사 할인 혜택. 암 예방 프로그램 연계.",
        "자궁암, 난소암 등 여성암 전용 보장. 임신·출산 후 발생암 확대.",
        "남성암(전립선, 고환암) 특화 담보. 암 이외 중증질환 추가 선택 가능.",
        "가족력 있는 경우 보험료 할인 혜택. 장기 납입 시 해지환급금 보장.",
        "암 1~4기 구분 없이 동일 진단금 지급. 중대수술 시 2배 보상.",
        "항암치료 장기입원비, 호스피스 병동 지원. 전문 간병인 매칭 특약.",
        "초음파·CT·MRI 등 검사비 보장 강화. 2차 진단시 재보상 옵션.",
        "약관상 위암, 식도암, 소장암까지 포함. 소화기암 특화 보장 가능.",
        "암 사망 시 유족연금 지급형 특약. 상속세 절감 플랜 별도 운영.",
        "정기검진 결과 고위험군이면 보험료 할인. 건강관리 앱 연동 혜택.",
        "항암치료 이동 교통비, 숙박비 일부 지원. 암 환자 생활지원금 특약.",
        "암진단 후 5년 무사고 시 보험료 환급. 동반질환(당뇨, 고혈압) 병행 보장."
    ],
    "수술/입원비": [
        "질병·상해 수술비부터 입원비까지 포괄 보장. 중환자실 특약 가능.",
        "대학병원/상급병실 입원 차액 지원. 간호인력 비용 일부 포함.",
        "복강경, 로봇수술 등 첨단수술비 추가. 고액수술 한도 상향.",
        "혈관질환, 장기이식 등 중대수술 보장 강화. 재활치료비 별도 특약.",
        "입원 1일당 정액 지원 + 수술비 별도. 병실 업그레이드 옵션.",
        "응급실 내원비, 중환자실 초기비용 보상. 외상성 상해 처리비 포함.",
        "무사고 시 수술비 환급 옵션. 납입면제 조건 확대.",
        "수술회복 단계별 간호비 지원. 통원치료 시 교통비 일부 보상.",
        "각종 내시경 수술, 레이저수술 보장. 전문센터 이용 시 할인 혜택.",
        "골절, 인공관절 치환, 디스크 수술 포함. 재수술 시 추가 보장.",
        "수술 후 재활물리치료, 도수치료 특약. 2차 감염 치료비 보상.",
        "특정질환(암·뇌·심장) 수술비 중복보장. 다회성 수술시 횟수 무제한.",
        "응급수술 시 긴급이송 헬기비용 보전. 동승 보호자 식대비 특약.",
        "로봇수술 기술료, 마취과 전문의 수가차액 커버. 진료비 추가 부담 감소.",
        "수술 후 자택 간호 서비스 일정기간 제공. 간병인 쿠폰 특약.",
        "펫동반 입원실 사용시 일부 차액 지원. 이색 특약.",
        "심장수술·뇌수술 시 재활간병 집중케어. 고액수술 특약으로 2배 보상.",
        "미용 목적 제외, 치유 목적 성형수술은 일부 제한적 보장. 재건술은 심사 후.",
        "1일 이상 입원 시 입원일당×(수술 난이도계수) 형태로 차등 보상.",
        "치과수술(악교정 등) 보장되는 플랜 확장. 치과전문의 협진비 포함."
    ],
    "종신": [
        "사망 시 유족보험금 평생 지급. 중도 해지 시 환급률 높음.",
        "정액사망보장 + 뇌·심장질환 특약. 변액 종신으로 투자수익 연동.",
        "유가족 연금형 수령 가능. 저해지형 설계로 보험료 부담 완화.",
        "치매, 말기질환 시 선지급특약. 상속 설계용으로 활용 가능.",
        "재해사망, 상해사망 추가 담보. 노후 간병자금 옵션 병행.",
        "생활자금선지급형: 중증질환 진단 시 사망보험금 일부 선지급.",
        "납입기간 단축형 선택 가능(10년·15년). 해지환급금 극대화 플랜.",
        "중대질병(암·뇌졸중) 사망 시 2배 보상. 배우자 전환특약.",
        "단축형 변액 종신: 해지환급금 변동형. 투자수익률에 따라 보장 확대.",
        "사후 상속지급 시 금융상속공제 혜택. 재테크용으로 인기.",
        "배우자 연결 종신 옵션(세대간 상속). 자녀 양육비 연금화 가능.",
        "계약대출(약관대출) 이율 인하 혜택. 가입 3년 후부터 대출 가능.",
        "종신 + 연금 혼합 설계 가능. 노후 준비와 유족보장 병행.",
        "MCI(경증치매) 진단 시 사망금 일부 선지급. 간병비로 사용 가능.",
        "자녀가 2명 이상이면 가족특약 할인 혜택. 유가족 생활 안정화.",
        "사망보험금 5억까지 고액 설정 가능. 기업체 대표용 플랜 지원.",
        "고액자산가 특화: 상속세 대비용. 절세컨설팅 연계 제공.",
        "월납, 연납, 일시납 등 납입방법 자유. 라이프스타일에 맞춤 설계.",
        "암진단 후 1년 내 사망 시 추가 보상. 유족 심리지원 서비스.",
        "정년도래형: 60세/65세 이후 보험료 납부 종료, 평생 보장."
    ],
    "운전자/상해": [
        "교통사고 처리지원금, 벌금, 변호사 비용, 면허취소 지원 등 종합보장.",
        "상해 입원비, 후유장해 보장. 자전거·킥보드 등 개인이동수단 특약.",
        "자동차 사고 외에 보행 중 상해도 보장. 생활배상책임 추가 가능.",
        "음주운전 벌금 일부 제외 특약(도덕적 해이 방지). 안전운전 할인.",
        "뺑소니·무보험차 상해 보장 강화. 긴급 견인 서비스 무제한.",
        "면허정지, 취소 시 위로금 지급. 벌금 한도 3천만원까지 확대.",
        "법률비용지원: 변호사 선임비, 합의금, 민사소송 비용까지 포함.",
        "영업용 차량(택시, 버스) 운전자 위한 특화 담보. 산재 보완 기능.",
        "골프카트, ATV, 전동휠 등 레저용 이동장치 상해 보장. 이색 특약.",
        "가족 운전 중 사고 시 동일 보장. 부부 특약 할인 적용.",
        "이륜차(오토바이) 상해까지 확장 가능. 배달 라이더 전용 설계.",
        "출퇴근·업무 중 교통상해 보상 특별약정. 고위험 직군 할인 보완.",
        "과속·신호위반 시 벌금, 형사합의금 일부 보장. 단, 반복 위반 시 예외.",
        "임시 차량 대체 시에도 계속 보장. 렌터카, 공유차 서비스 포함.",
        "면허 재취득 비용 지원 특약. 사고 후 심리상담 프로그램 연계.",
        "현장출동 서비스(배터리, 타이어교체) 연 5회 무료. 재난시 추가 지원.",
        "부상등급별 위로금 체계. 중상해 시 집중 간병비 옵션.",
        "동승자 상해 보장. 가족이 탑승했을 경우 별도 배상 특약.",
        "방어비용 특약(형사소송 대응). 블랙박스 설치 시 보험료 할인.",
        "장기무사고 시 보험료 환급. 안전운전 습관 측정 앱 연동으로 추가 할인."
    ],
    "주택화재": [
        "화재, 폭발, 누출 피해 보장. 가재도구 손실 배상 확대.",
        "자연재해(태풍, 홍수) 보장 범위 강화. 임시 거주비 최대 6개월 지원.",
        "누수로 인한 이웃집 피해 배상. 위자료 및 도배 교체비 포함.",
        "단독주택, 아파트, 오피스텔, 빌라 등 모든 주거형태 적용 가능.",
        "도난·파손 특약 가능. 침입 시도 시 파손비용 일부 보상.",
        "임차인 배상책임(전세, 월세) 별도 설정. 집주인·세입자 모두 안심.",
        "보일러, 가스레인지, 수도 배관사고까지 보장 범위 확대.",
        "바람, 우박, 낙뢰 등 풍해·우박·낙뢰 특약 가입 시 보수 비용 지원.",
        "지진 발생 시 건물 균열, 붕괴 일부 커버. 지진담보 특약 한도 설정.",
        "주택가스 폭발사고, 화상 치료비 추가 보장. 인명 피해 위로금 포함.",
        "가전제품(에어컨, TV, 냉장고) 망실 시 실비 배상. 노후 제품은 감가.",
        "반려동물 동반 대피 시 임시보호소 비용 특약. 파견 간병인 쿠폰 제공.",
        "고층건물(30층 이상) 화재시 고가사다리차 이용비 부담 일부 보전.",
        "노후주택(건축 30년 이상) 특별심사 후 가입 가능. 일부 추가 할증.",
        "불법 증축 부분 사고도 일정부분 배상 처리(단, 심사 필요).",
        "소방법 준수 건물(스프링클러, 화재경보기 설치) 시 할인.",
        "주택 내 지진계측기 설치 시 추가 할인. 재난지원금 연계.",
        "주거+창고 복합건물도 통합 보장 가능. 단, 사업용 부분 제외.",
        "공동주택 층간소음 갈등으로 인한 기물파손도 일부 배상.",
        "무사고 3년 시 프리미엄 환급. 장기유지 보너스 프로그램."
    ],
    "치아": [
        "스케일링, 충치, 신경치료 보장. 임플란트 특약 최대 2개.",
        "치아보철(크라운, 브릿지) 교정치료 일부 지원. 어린이 교정은 별도 옵션.",
        "치과 응급치료, 잇몸치료비 커버. 미백치료는 제외.",
        "임플란트 재료 상향 시 추가 지원. 세라믹, 지르코니아 등 고가재료 부담 경감.",
        "치아파절, 발치, 근관치료(신경치료) 단계별 정액 지급. 2차 재치료 보장.",
        "어금니, 송곳니 등 보철치료 집중 보장. 골이식술 일부 비용 지원.",
        "치주질환(잇몸 염증, 치조골 손실) 치료비 확대. 정기검진 할인 연계.",
        "부분틀니, 전체틀니 보장. 유지·관리 비용 연 1회 추가.",
        "스케일링 연 2회 커버형 특약. 치과의사협회 등록병원 이용 시 혜택.",
        "유아·어린이 충치치료, 실란트 시술비 등 50~80% 보장.",
        "치과 전용 응급실 이용 시 야간·공휴일 할증 비용 보상. 외상치아 특약.",
        "브라켓 교정, 인비절라인 등 투명교정 일부 지원(사유 심사 후).",
        "임신 중 치아건강 특별관리비용. 산모 치주질환 치료비 부담 낮춤.",
        "치아염증 재발 시 2차 치료 비용 추가. 6개월 이내 재치료 보완.",
        "보철 파손 시 재제작 비용 커버. 지진·사고 등 외부 요인도 포함.",
        "온레이, 인레이 보장 범위 상향. 금 인레이와 레진 비용 차액 지원.",
        "충치 3개 이상 동시 치료 시 패키지 지원금(일부 한도 내).",
        "의치, 덧니 보정 비용 별도 담보. 심미성 교정 제외 시 보험료 할인.",
        "치과 검진 앱 연동 시 교정 전후 관리 서비스. 영양상담 쿠폰 제공.",
        "임플란트 후 통증관리 약제비, 소염진통제 비용 일부 지원."
    ],
    "치매": [
        "경도치매부터 중증치매까지 단계별 진단비, 간병비 보장. 장기요양등급별 확대.",
        "치매 간병인 24시간 파견 특약. 1회 최대 30일 지원.",
        "알츠하이머, 혈관성 치매 집중보장. 중증도별 월 생활비 지급.",
        "부부 동시 치매 발생 시 가족케어자금 2배. 배우자 케어 특약 포함.",
        "MCI(경도인지장애) 단계부터 조기치료비 지원. 예방프로그램 할인.",
        "치매 전담 요양원 입소 시 시설비 일부 커버. 재활치료비 보완.",
        "장기요양 1~5등급에 따라 매월 간병비 차등 지급. 최대 36개월 보장.",
        "치매 진단 시 보험료 납입면제. 보호자 심리지원 서비스.",
        "치매환자 실종보험금(배회감지기) 지원. 위치추적기 구입비 일부 부담.",
        "간병 보호자 교대휴가비, 심리상담비 등 추가 담보. 국가 지원 연계.",
        "인지재활치료(작업요법, 언어치료) 비용 특약. 전문센터 이용 시 할인.",
        "치매약제비(도네페질 등) 월 정액 지원. 비급여 부분 보완.",
        "가족 중 치매 이력 있으면 가입 시 할인(유전자 스크리닝 동의 시).",
        "중증치매로 장기입원 시 간병병실 차액 지원. 간호인 인력비 포함.",
        "재진단 시 중도 보장금 선지급. 환자 이송비(이동차량) 커버.",
        "치매 환자용 안전용품(낙상 방지 매트, 안전바) 구매비 일부 지원.",
        "집에서 돌보는 재가간병 형태 시 생활비 지원. 방문요양 쿠폰.",
        "치매 사망 시 추가 위로금, 유족연금형 지급 특약. 상속세 대비 옵션.",
        "양로시설, 실버타운 거주 시 보증금 손해 지원. 시설 파산 위험 대비.",
        "치매 환자 돌봄 가족에 대한 심리상담, 휴식캠프 특별혜택 연 1회."
    ],
    "신생아": [
        "출생 직후부터 미숙아, 선천질환 보장. 인큐베이터 입원비 지원.",
        "중환자실, 인큐베이터 비용 특약. 예방접종비 50% 할인 혜택.",
        "산모 위험담보, 제왕절개 수술비 일부 보장. 어린이보험 전환 가능.",
        "저체중아(2.5kg 미만) 집중케어. 수술비, 재활치료비 별도 한도.",
        "선천성 심장질환, 구개열, 대사이상질환 등 희귀질환 보장 확대.",
        "산모-신생아 동시 입원 시 병실차액 지원. 간병인 7일 제공 특약.",
        "태아 때 초음파 검사비 일부 환급. 가입 시 산전검사 쿠폰 제공.",
        "신생아 황달, 호흡곤란 증후군 등 NICU 치료비 집중 보장.",
        "예방접종 완료 시 보험료 일부 환급. 돌 이전 5회 접종비 할인.",
        "산후조리원 이용비용 특약. 일부 지정기관 할인 연계.",
        "배꼽탈장, 잠복고환 등 경미한 선천질환도 일정금액 보장.",
        "엄마와 아이 함께 통합보장 가능. 출산합병증, 난산 위험 담보.",
        "미숙아 퇴원 후 재활치료, 언어치료 담보 가능. 성장발달 지원.",
        "1세 이전 어린이 상해·화상·골절 보장. 응급실 내원비 포함.",
        "산후 우울증 치료비 특약(산모), 신생아 양육코칭 무료 지원.",
        "쌍둥이 출산 시 추가 할인 특약. 다태아 전문 간호사 파견.",
        "아토피, 알레르기성 비염 초기치료비 보강. 소아청소년과 진료비 연계.",
        "소아치과 초기진료(치아 우식 예방) 1회 무료 혜택. 이유식 지원 쿠폰.",
        "영유아 건강검진 비용 전액 지원(정부 지원 외 추가). 부모 교육 세미나 쿠폰.",
        "아이 성장단계별(6개월, 1세, 2세) 건강검진 확대. 돌봄 서비스 연계."
    ]
}

# (생략된 부분) - 나머지 카테고리 내용도 위에서처럼 20개 이상 준비
# -----------------------------------------------------------------------------

# 2-1) 카테고리 목록
categories = list(base_coverage_details.keys())

# 2-2) 카테고리별 50개로 확장
coverage_details_map_final = {}
for cat, details in base_coverage_details.items():
    new_list = details[:]
    base_len = len(new_list)
    if base_len < 50:
        for i in range(base_len+1, 51):
            new_detail = f"{cat} 확장 문구{i}: (테스트용 더미 보장내용)"
            new_list.append(new_detail)
    coverage_details_map_final[cat] = new_list


#############################
# 3. CSV 생성 로직
#############################

def generate_insurance_products(num=1000):
    data = []
    product_id_start = 1

    for i in range(num):
        # 회사, 상품명, 카테고리, 보장내용 등 무작위 조합
        company = random.choice(list(possible_products_final.keys()))
        product_name = random.choice(possible_products_final[company])

        category = random.choice(categories)
        coverage_list = coverage_details_map_final[category]
        coverage_details = random.choice(coverage_list)

        monthly_premium = random.randint(15000, 60000)  # 1.5만 ~ 6만
        min_age = random.choice([0, 18, 20, 30])
        max_age = random.choice([60, 65, 70, 75, 80])
        if min_age > max_age:
            min_age, max_age = max_age, min_age

        data.append([
            product_id_start,
            company,
            product_name,
            category,
            coverage_details,
            monthly_premium,
            min_age,
            max_age
        ])
        product_id_start += 1

    return data

def save_insurance_products_csv(data, filename="insurance_products.csv"):
    headers = ["product_id", "company_name", "product_name", "product_category",
               "coverage_details", "monthly_premium", "min_age", "max_age"]
    with open(filename, "w", newline="", encoding="utf-8") as f:
        writer = csv.writer(f)
        writer.writerow(headers)
        writer.writerows(data)


#############################
# 사용자 건강정보 (사람 정보)
#############################
first_names = ["김", "이", "박", "최", "정", "강", "조", "윤", "장", "오", "한", "신", "서", "유", "권", "황", "안", "송", "전", "홍"]
middle_tail_names = ["나라","민기","용기","화경","정은","혜정","윤지","영찬","지영","지수","준빈","기영","진원",
                     "채연","종혁","유진","민수","민지","영희","미영","재훈","도윤","서연","지민","하윤","서현",
                     "지원","현우","유정","가영","상민","동혁","다은"]

def generate_user_health_info(num=1000):
    data = []
    health_id_start = 1

    chronic_opts = ["", "고혈압", "당뇨", "고지혈증", "천식", "관절염", "뇌졸중", "협심증", "암", "간염"]
    surgery_opts = ["", "치아 임플란트(2021)", "맹장 수술(2019)", "슬관절 수술(2018)",
                    "유방암 수술(2020)", "기관지 확장 수술(2017)", "심장 스텐트(2022)"]

    for i in range(num):
        health_id = health_id_start
        fn = random.choice(first_names)
        mn = random.choice(middle_tail_names)
        user_name = fn + mn  # 예: 김서현, 이재훈

        age = random.randint(0, 85)
        gender = random.choice(["M", "F"])
        height = random.uniform(150.0, 180.0)
        weight = random.uniform(45.0, 90.0)
        bmi = round(weight / ((height/100)**2), 1)

        is_smoker = random.randint(0, 1)
        is_drinker = random.randint(0, 1)

        # 만성질환
        has_chronic_disease = 0
        cdl = ""
        if random.random() < 0.3:
            has_chronic_disease = 1
            pick = random.sample(chronic_opts[1:], random.randint(1,2))
            cdl = ", ".join(pick)

        # 수술 이력
        sh = ""
        if random.random() < 0.2:
            sh = random.choice(surgery_opts[1:])

        # 혈압
        systolic = random.randint(100, 160)
        diastolic = random.randint(60, 100)
        bp = f"{systolic}/{diastolic}"

        # 혈당
        sugar = random.randint(80, 140)
        bs = f"{sugar} mg/dL"

        data.append([
            health_id,
            user_name,
            age,
            gender,
            round(height,1),
            round(weight,1),
            bmi,
            is_smoker,
            is_drinker,
            has_chronic_disease,
            cdl,
            sh,
            bp,
            bs
        ])
        health_id_start += 1

    return data

def save_user_health_info_csv(data, filename="user_health_info.csv"):
    headers = [
        "health_id", "user_name", "age", "gender", "height", "weight", "bmi",
        "is_smoker", "is_drinker", "has_chronic_disease", "chronic_disease_list",
        "surgery_history", "blood_pressure", "blood_sugar"
    ]
    with open(filename, "w", newline="", encoding="utf-8") as f:
        writer = csv.writer(f)
        writer.writerow(headers)
        writer.writerows(data)


#############################
# 메인 실행부
#############################
if __name__ == "__main__":
    # 1) 회사/카테고리 확장 + 사용자/상품 생성
    # 2) CSV 쓰기

    # 상품 더미 1,000건
    products_data = generate_insurance_products(num=1000)
    save_insurance_products_csv(products_data, "insurance_products.csv")

    # 사용자 건강 더미 1,000건
    users_data = generate_user_health_info(num=1000)
    save_user_health_info_csv(users_data, "user_health_info.csv")

    print("CSV 파일 생성 완료!")
    print("- insurance_products.csv")
    print("- user_health_info.csv")
