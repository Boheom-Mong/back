import random
import csv
import os

#############################
# 1) 보험상품 리스트 (회사별 실제명처럼)
#############################
base_products = {
    "삼성화재": [
        "삼성화재 New 암플랜",
        "삼성화재 건강보험 통합형",
        "삼성화재 종신보험 스마트",
        "삼성화재 운전자패키지 Plus",
        "삼성화재 치아보험 웰라이프",
        "삼성화재 The건강한 플랜",
        "삼성화재 다이렉트 실손건강",
        "삼성화재 행복한 보장 플랜",
        "삼성화재 수술입원 통합보장",
        "삼성화재 무배당 내아이 케어",
        "삼성화재 신생아 희망케어",
        "삼성화재 치매간병 안심플랜",
        "삼성화재 스마트 운전자케어",
        "삼성화재 가정화재 종합보장",
        "삼성화재 알뜰한 치아케어"
    ],
    "DB손해보험": [
        "DB손해보험 참좋은 암보험",
        "DB손해보험 운전자보험 프로미",
        "DB손해보험 종합건강수술비",
        "DB손해보험 아이러브건강",
        "DB손해보험 웰케어 실손보험",
        "DB손해보험 노블레스 종신",
        "DB손해보험 수술입원비 플러스",
        "DB손해보험 치아든든케어",
        "DB손해보험 고혈압당뇨 케어플랜",
        "DB손해보험 하우스안심 화재보험",
        "DB손해보험 암플러스 3대질환",
        "DB손해보험 치매간병 프리미엄",
        "DB손해보험 신생아 미숙아보장",
        "DB손해보험 가정종합화재 특별약정",
        "DB손해보험 다이렉트 운전자보험"
    ],
    "KB손해보험": [
        "KB 암보험 플래티넘",
        "KB 치아보험 스마일",
        "KB 운전자보험 스마트운전",
        "KB 종신보험 행복누리",
        "KB 치매간병보험 안심케어",
        "KB 종합건강보험 The Care",
        "KB 실손의료비 표준플랜",
        "KB 신생아케어 안심보장",
        "KB 주택화재 종합프로",
        "KB 운전자라이프 파워",
        "KB 무배당 암케어슈퍼",
        "KB 뇌심장질환 종합보장",
        "KB 골든라이프 종신플랜",
        "KB 치아안심 파워케어",
        "KB 다이렉트 입원수술 종합"
    ],
    "현대해상": [
        "현대해상 굿앤굿종합보험",
        "현대해상 하이카 운전자보험",
        "현대해상 신실손의료비보험",
        "현대해상 암스트롱 암보험",
        "현대해상 The 간편건강보험",
        "현대해상 수술입원 안심케어",
        "현대해상 종신플랜 브라이트",
        "현대해상 치아케어 치유플러스",
        "현대해상 주택화재 맘편한",
        "현대해상 운전자 패밀리안심",
        "현대해상 치매보장 뉴케어",
        "현대해상 노후실손 간편보장",
        "현대해상 다이렉트 건강입원비",
        "현대해상 신생아 고위험케어",
        "현대해상 수술비 더든든"
    ],
    "메리츠화재": [
        "메리츠 알파Plus 보장보험",
        "메리츠 운전자보험 안전플랜",
        "메리츠 치아보험 내돈제로",
        "메리츠 종신보험 든든케어",
        "메리츠 실손의료비 New",
        "메리츠 암보험 파워케어",
        "메리츠 어린이건강 행복지킴이",
        "메리츠 수술입원비 블루케어",
        "메리츠 암수술 특약플러스",
        "메리츠 치아사랑 메디케어",
        "메리츠 주택화재 가정지킴이",
        "메리츠 치매든든 종합간병",
        "메리츠 단독운전자 안심보장",
        "메리츠 유니버셜 종신플랜",
        "메리츠 실버케어 건강입원"
    ],
    "한화손해보험": [
        "한화손해 스마트치아보험",
        "한화손해 암보험 3대질환케어",
        "한화손해 안심운전자 종합",
        "한화손해 주택화재 AllSafe",
        "한화손해 실손의료비 표준형",
        "한화손해 치매케어 파워플랜",
        "한화손해 어린이 New케어",
        "한화손해 저축성 종신보험",
        "한화손해 하이종신 든든보장",
        "한화손해 암수술비 업그레이드",
        "한화손해 수술입원 The건강",
        "한화손해 치아굿케어 A+",
        "한화손해 운전자배상 종합안심",
        "한화손해 신생아스페셜 보장",
        "한화손해 노후치매 프리미엄"
    ],
    "롯데손해보험": [
        "롯데 가온종합보험",
        "롯데 치아건강보험",
        "롯데 암보험 바로OK",
        "롯데 운전자보험 드림카",
        "롯데 수술입원 종합케어",
        "롯데 종신보험 행복드림",
        "롯데 신생아 안심플랜",
        "롯데 치매보장 New해피라이프",
        "롯데 화재플러스 내집안심",
        "롯데 실손의료비표준 A형",
        "롯데 어린이건강 Smart",
        "롯데 운전자 무배당 프로",
        "롯데 치아실속케어 B형",
        "롯데 암입원프리미엄 플랜",
        "롯데 노후실손 든든케어"
    ],
    "흥국화재": [
        "흥국화재 착한운전자보험",
        "흥국화재 행복을다주는암보험",
        "흥국화재 간병치매보험 안심",
        "흥국화재 주택화재 럭키홈",
        "흥국화재 종신플러스 NewLife",
        "흥국화재 수술입원 Protect",
        "흥국화재 어린이미래 파워케어",
        "흥국화재 치아클리닉 굿케어",
        "흥국화재 운전자안전 all-in",
        "흥국화재 신생아 출산플랜",
        "흥국화재 암간병 든든플러스",
        "흥국화재 실손건강 표준형",
        "흥국화재 치매간병 해피라이프",
        "흥국화재 노후장기 케어플랜",
        "흥국화재 유니버셜 종신 New"
    ]
}

#############################
# 2) 카테고리(Enum)별 보장내용 map
#############################
base_coverage_details = {
    "CANCER": [
        "주요암(유방암, 폐암, 위암) 보장. 항암주사비 지원, 확진 시 수술비 지급.",
        "유전성 암 스크리닝 할인, 가족력 있는 경우 보험료 감면 적용.",
        "재진단암(2차) 보장, 항암약물치료비 일부 지원. 종합적인 사후관리 프로그램.",
        "말기암 간병특약, 호스피스 시설 비용 지원, 통원 교통비 최대 30만원.",
        "초기암부터 고액암까지 단계별 혜택. 최신 면역항암치료 보장.",
        "암 사망 시 유족연금 지급형 가능, 배우자 전환보험 할인.",
        "표적항암약물, 면역치료 보장 확대. 중증암(4기) 상향지급.",
        "소액암(갑상선암, 기타피부암 등)부터 전이암까지 폭넓게 커버.",
        "5년 무사고 시 보험료 환급 옵션, 건강관리 리워드 제공.",
        "정기검진 결과 고위험군이면 추가 보장금액 20% 상향."
    ],
    "SURGERY": [
        "수술비·입원비 포괄 보장. 로봇수술 특약 별도. 수술 난이도에 따라 차등 지급.",
        "복강경, 관절, 디스크 등 정형외과 수술 집중 강화. 도수치료 연계.",
        "응급수술 시 닥터헬기 이송비, 보호자 식대비 지원. 재활치료 특약.",
        "수술 후 2차 재활치료비(물리치료, 도수치료) 담보, 회복 프로그램 제공.",
        "무사고 시 수술비 환급 옵션. 건강검진 쿠폰 연1회.",
        "특정질환(암·뇌·심장) 수술비 2배 지급 특약. 재진단 포함.",
        "심장수술·뇌수술 고액 특약 별도. 집중케어센터 비용 지원.",
        "치과수술(악교정, 임플란트) 일부 커버. 미용 목적 성형은 제외.",
        "입원일당×(수술난이도계수)로 차등 보상. 1인실 특약 가능.",
        "수술 전후 전문간호사 방문 케어, 온라인 화상진료 서비스."
    ],
    "LIFE": [
        "사망 시 유족보험금 평생 지급. 중도 해지환급 일부 가능.",
        "정액사망보장 + 뇌·심장질환 특약 가입. 납입기간 10년/20년 선택.",
        "납입기간 단축(10/15년), 고액 해지환급 설계 가능. 유가족 생활비 옵션.",
        "배우자 연결 종신, 자녀 교육비 연금화 가능. 유언대용신탁 서비스 연계.",
        "암·뇌졸중 사망 시 2배 보상 특약. 상속세 절감 플랜 상담 제공.",
        "기업 오너용 상속세 대비 플랜 가능. 신탁계약 연동.",
        "정년도래형: 60세 납 끝, 평생 보장. 납입면제(장해등급) 옵션.",
        "생활자금선지급형: 중증질환 진단 시 일부 지급, 간병비 활용.",
        "MCI(경증치매) 선지급, 요양시설비 보완. 가족간병 지원금.",
        "변액 종신, 투자수익 연동 해지환급 가능. 수익률 옵션형."
    ],
    "DRIVER": [
        "교통사고 처리지원금, 변호사 선임비, 벌금 지원. 합의금 보전.",
        "상해 입원비, 후유장해 보장. 자전거·오토바이 특약 별도.",
        "음주운전 벌금 일부 제외(도덕적 해이 방지). 블랙박스 설치 할인.",
        "무보험차 상해, 긴급견인 무제한. 해외운전특약(국제면허) 선택가능.",
        "면허정지/취소 위로금, 벌금 한도 3천만원. 가족 운전 시 동일보장.",
        "법률비용지원: 형사합의금, 변호사비 추가. 전문팀 상담 서비스.",
        "배달 라이더 전용, 이륜차 상해 확장 보장, 위로금 확대.",
        "가족 운전 중 사고시 동일 보장. 자녀연령 상관없이 가입.",
        "면허 재취득 비용 특약, 심리치료 연계. 사고 트라우마 케어.",
        "장기무사고 환급, 스쿨존/어린이보호구역 사고추가보장."
    ],
    "FIRE": [
        "화재, 폭발, 누출 피해. 가재도구 망실까지 포괄 보장.",
        "자연재해(태풍, 홍수) 임시거주비 최대 6개월. 도난 특약 포함.",
        "임차인 배상책임 별도. 전세·월세 모두 가입 가능. 보증금 보호.",
        "화상 치료비, 인명 피해 위로금 커버. 의료비 추가 특약.",
        "보일러, 수도 파열사고 확대. 자동화재탐지시설 설치 시 할인.",
        "고층건물 화재 시 고가사다리차 비용 보전. 엘리베이터 복구비.",
        "노후주택(건축30년↑) 특별심사, 일부 할증. 안전검사 연계.",
        "반려동물 대피 시 임시보호소 비용. 긴급펫택시 지원.",
        "지진담보 특약, 건물 균열·붕괴 대비. 내진설계 시 할인.",
        "무사고 3년 환급, 장기유지 보너스. 친환경 자재 사용 가점."
    ],
    "DENTAL": [
        "스케일링, 충치, 신경치료 보장. 임플란트·브릿지·크라운 특약.",
        "치아보철, 교정 일부 지원. (어린이 교정은 별도 옵션)",
        "치주질환, 발치, 근관치료 단계별 정액 보장. 주기적 검진 쿠폰.",
        "어금니, 골이식술 일부 비용. (금니, 세라믹 재료비 제한)",
        "스케일링 연2회, 협회 등록병원 할인. 칫솔질 코칭 앱 지원.",
        "유아·어린이 충치치료, 실란트 시술 50% 이상 보장.",
        "임신 중 치아건강 특별관리, 산모 치주질환 예방 패키지.",
        "치아염증 재발 시 2차 치료비 커버. 노인 틀니 교체 특약.",
        "보철 파손 재제작 비용 보상. (충돌사고, 이물질파손 등)",
        "임플란트 후 통증관리 약제비 일부. 치과치료 전담 콜센터."
    ],
    "DEMENTIA": [
        "경도치매~중증치매 단계별 간병비. 장기요양등급별 연금지급.",
        "치매 간병인 24시간 특약, 배우자·부모 동시 발생 시 2배보장.",
        "알츠하이머, 혈관성 치매 집중 담보. 재활치료, 언어치료 포함.",
        "치매 진단 시 보험료 납입면제. 보호자 심리상담, 가족케어 교육.",
        "가족 중 치매 이력 있으면 가입 할인. (건강검진결과 제출)",
        "중증치매 간병병실 차액 지원. 호스피스 비용, 배회감지기.",
        "인지재활치료(작업·언어) 비용 특약, 재가요양 서비스 연계.",
        "치매 환자 실종보험금, 배회감지기 보조금. 경찰 공조 시스템.",
        "장기요양1~5등급 월 간병비, 최대 36개월 연속 지급.",
        "치매 사망 시 위로금, 유족연금형 선택 가능. 간호전문매니저 배정."
    ],
    "NEWBORN": [
        "출생 직후 미숙아·선천질환 보장, 인큐베이터 입원비, NICU 비용.",
        "산모 위험담보, 제왕절개 수술비 등 출산 관련 수술비. 산후케어 포함.",
        "저체중아 집중케어, 희귀질환 확대 담보. 유전검사 추가옵션.",
        "1세 이전 상해·화상·골절 보장, 응급실 포함. 예방접종비 일부.",
        "쌍둥이 출산 시 추가 할인 특약. 배우자 입원일당 추가.",
        "아토피, 알레르기성 비염 초기치료 보강. 영유아·소아과 연계.",
        "영유아검진 비용 전액 지원(정부 지원 외 추가), 성장단계 관리.",
        "신생아 황달, 호흡곤란증후군 집중보장. 맞춤형 수유교육.",
        "산후조리원 이용비, 제휴 산후도우미 할인 쿠폰. 산모심리상담.",
        "태아 때 초음파 검사비 환급, 2세까지 무사고 시 보험료 부분 환급."
    ],
    "HEALTHCARE": [
        "표준 실손의료비, 급여·비급여 통원/입원 보장. 연간 한도 내 무제한 청구.",
        "본인부담금(약국·처방조제료, MRI 등) 지원. 도수치료, 증식치료 제한적 커버.",
        "상급병실 차액, 특진료 일부 담보. 대학병원 1인실 차액 정액지원.",
        "중증질환(암·뇌·심장) 고액치료비 한도 확대. 간호간병통합서비스 제공.",
        "미용 목적 시술 제외, 치료목적 성형은 일부 보장. 사전심사제.",
        "대학병원 1인실 차액 정액지원, 추가간병비 특약. 중환자실 2배 보장.",
        "약국 본인부담금, 처방조제료 연간 n회 제한. 건강관리 앱 연계 쿠폰.",
        "4세대 실손구조, 과다 이용 시 할증. 합리적 청구 유도.",
        "중증질환(항암치료, 뇌수술) 본인부담 0원 특약 가능. 고액치료 집중.",
        "재진 입원 시 간병비 50% 보조, 요양병원 전원지원."
    ],
    "CHILD": [
        "어린이(0~15세) 질병·상해 종합. 골절, 화상, 입원일당, 응급수술 지원.",
        "소아암(백혈병, 뇌종양) 특화담보. 재진단암도 일부 보장. 항암약물치료비.",
        "어린이 치아치료, 실란트 시술 50% 이상 보장. 교정비는 별도 특약.",
        "학교·학원 사고, 통원치료비, 응급실 비용 보장. 외부활동 배상책임.",
        "정신건강상담 특약(ADHD, 틱장애 등). 전문가 매칭 서비스.",
        "만기 후 성인용 전환 가능, 저해지 설계. 부모 동반 플랜 할인.",
        "피부질환(아토피, 습진), 알레르기성 비염도 특별 담보.",
        "입원 간병인 쿠폰, 부모 동반 간이침대비. 가족 전용병실 할인.",
        "어린이 뇌전증 등 희귀질환 지원. 국가검진 외 추가비용.",
        "영양상담·성장검진 할인 연계, 유아용 영양식 배송 쿠폰."
    ],
    "PET": [
        "반려동물(개·고양이) 의료비 보장. 수술, 입원, 통원비 등 종합 커버.",
        "중성화수술비, 예방접종비 일부 환급. 광견병·종합백신 지원.",
        "산책 중 타인 배상책임 담보, 한도 설정 가능. 동물등록비 할인.",
        "노령동물(10세 이상) 가입할증, 주기적 건강검진 권장. 치매특약.",
        "암진단 시 고액치료비 일부 보전. 항암제·면역치료까지 확대.",
        "슬관절 탈구, 피부질환 등 특정품종 특약. 명절 펫호텔 할인.",
        "펫장례 특약(화장, 봉안), 펫로스 증후군 심리상담 지원.",
        "반려견 등록비, 유실견 찾기 쿠폰 연계. GPS 목걸이 할인.",
        "수술 후 재활(수중런닝머신) 일부 보상. 재활전문동물병원 제휴.",
        "가입 시 펫사료 할인쿠폰, 정기검진 안내. 백신 알림 서비스."
    ],
    "NURSING": [
        "간병보험: 장기요양 1~5등급 등급별 간병비 월지급. 재가간병 특약.",
        "요양병원 입원비, 간병인 고용비 일부 커버. 방문간호, 복지용구 지원.",
        "퇴원 후 방문간호(주2회), 재활치료비 보조. 주거개조비 특약.",
        "납입면제(중증질환) 제도, 가족간병 특약. 배우자 동반 가입 할인.",
        "치매·뇌졸중 등 노인성질환 간병비 연동. 간병일시금 최고 2,000만원.",
        "방문요양 쿠폰 연2회, 보호자 심리상담 무료. 전화건강모니터링.",
        "시설입소 보증금 파손 위험 담보. 파산 시 일부 환급 안전장치.",
        "간편심사(3·2·1문) 노령층 가입 용이. 고령자 전용 무심사형.",
        "재활치료비, 작업치료 옵션 별도 가입. 요양시설 등급 파트너십.",
        "무심사형(보장금액 제한) 플랜 존재. 근력강화 프로그램 할인."
    ],
    "TRAVEL": [
        "해외여행 중 질병·상해, 항공기 지연, 수하물 파손 보장. 여권 재발급 비용.",
        "스키, 스쿠버 등 레저특약(고위험 할증) 가능. 휴대품 파손 최대 100만원.",
        "코로나 확진 시 여행취소비용 일부 보상. 숙박 재예약비 담보.",
        "해외 입원, 현지 간호인 파견, 법률지원. 24시간 긴급 콜센터.",
        "항공편 결항, 숙박연장 비용. 일정 변경 수수료 보상.",
        "배상책임(타인·시설 파손) 변호사비, 통역 서비스. 분쟁 시 협조.",
        "스마트폰·노트북 분실·파손 한도. 도난신고 절차 안내.",
        "장기유학·워홀 전용 설계, 연장 가능. 해외 이주·이민도 상담.",
        "여행지 병원 예약, 통역지원, 긴급송환 항공권(비즈니스석) 특약.",
        "분쟁 발생 시 중재 비용 지원. 빌린 차량 파손 추가 특약."
    ],
    "ETC": [
        "골프보험: 골프장 내 상해, 장비 파손, 홀인원 비용까지 보장.",
        "낚시보험: 선상낚시 상해, 장비 파손, 조난 구조비용.",
        "반려식물보험: 화분 파손, 벌레 발생 방제비, 희귀 식물치료.",
        "악기파손보험: 공연 중 악기 파손, 도난 시 실비 지원.",
        "기업 임직원 단체상해, 복지특약, 보증보험 등 옵션 다양.",
        "축제·행사 배상책임, 인원안전 담보, 무대 장비 파손 보장.",
        "연예인·스턴트맨 고위험직군 전용. 산재 사각지대 보완 플랜.",
        "예술품·명품가방 파손·도난 담보. 해외전시 운송 중 파손도.",
        "농작물재해, 가축재해, 자연재해 연계특약. 재배장비 부분보상.",
        "우주여행 대비 고공비행보험(개발 중). 드론·캠핑장비 보장 등."
    ]
}


#############################
# 3) 보험상품 CSV 생성 로직
#############################

def generate_insurance_products(num=200):
    """
    - product_id: 1..num
    - company_name: from base_products.keys()
    - product_name: from base_products[company]
    - product_type: from base_coverage_details (Enum name)
    - coverage_details: from base_coverage_details[product_type] (랜덤)
    - monthly_premium: 20,000 ~ 100,000 사이 정수, 콤마 찍어서 저장 (ex: "23,000")
    """
    data = []
    product_id_start = 1
    companies = list(base_products.keys())
    category_list = list(base_coverage_details.keys())

    for _ in range(num):
        # 1) 회사 선택 -> 해당 회사의 상품명 중 하나 선택
        company = random.choice(companies)
        product_name = random.choice(base_products[company])

        # 2) 카테고리(보험타입) 선택 -> 해당 coverage 중 하나
        product_type = random.choice(category_list)
        coverage_candidates = base_coverage_details[product_type]
        coverage_text = random.choice(coverage_candidates)

        # 3) 월 보험료(콤마 표시)
        premium = random.randint(20000, 100000)
        premium_str = f"{premium:,}"  # 예: 23,000

        data.append([
            product_id_start,
            company,
            product_name,
            product_type,   # Enum name
            coverage_text,
            premium_str     # 콤마 찍힌 문자열
        ])
        product_id_start += 1

    return data

def save_insurance_products_csv(data, filename="insurance_products.csv"):
    headers = [
        "product_id",
        "company_name",
        "product_name",
        "product_type",
        "coverage_details",
        "monthly_premium"
    ]
    with open(filename, "w", newline="", encoding="utf-8") as f:
        writer = csv.writer(f)
        writer.writerow(headers)
        writer.writerows(data)


#############################
# 메인 실행 (원하는 갯수 조정)
#############################
if __name__ == "__main__":
    # 이미 CSV 파일이 존재하면 스킵 혹은 덮어쓰기를 결정
    if os.path.exists("insurance_products.csv"):
        print("[INFO] 'insurance_products.csv' 파일이 이미 존재합니다. 새로 생성하려면 삭제 후 실행하세요.")
    else:
        print("=== 보험상품 더미데이터 CSV 생성 시작 ===")
        product_data = generate_insurance_products(num=300)  # 원하는 개수로 변경
        save_insurance_products_csv(product_data, "insurance_products.csv")
        print("insurance_products.csv 생성 완료.")
        print("=== 작업 종료 ===")
